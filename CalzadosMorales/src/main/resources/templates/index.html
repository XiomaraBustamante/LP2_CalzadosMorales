<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" 
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <meta charset="UTF-8">
    <title>Dashboard | Calzados Morales</title>
    <link rel="stylesheet" href="assets/vendors/mdi/css/materialdesignicons.min.css"> 
    <link rel="stylesheet" href="assets/vendors/ti-icons/css/themify-icons.css"> 
    <link rel="stylesheet" href="assets/vendors/css/vendor.bundle.base.css"> 
    <link rel="stylesheet" href="assets/vendors/font-awesome/css/font-awesome.min.css"> 
    <link rel="stylesheet" href="assets/vendors/bootstrap-datepicker/bootstrap-datepicker.min.css"> 
    <link rel="stylesheet" href="assets/css/style.css"> 
    <link rel="shortcut icon" href="assets/images/favicon.png" />
    <style>
        .card-img-absolute { position: absolute; top: 0; right: 0; height: 100%; opacity: 0.4; }
        .page-title-icon { box-shadow: 0 4px 10px rgba(182, 109, 255, 0.3); }
    </style>
</head>

<body>
    <div class="container-scroller">
        <nav th:replace="~{fragmentos/navbar :: navbar}"></nav>
        <div class="container-fluid page-body-wrapper">
            <nav th:replace="~{fragmentos/sidebar :: sidebar}"></nav>

            <div class="main-panel">
                <div class="content-wrapper">
                    
                    <div class="page-header">
                        <h3 class="page-title">
                            <span class="page-title-icon bg-gradient-primary text-white me-2">
                                <i class="mdi mdi-home"></i>
                            </span> ¡Hola, <span th:text="${userNombreCompleto}">Usuario</span>! Bienvenid@ al sistema de Calzados Morales.
                        </h3>
                    </div>

                    <div th:if="${rolId == 2}">
                        <div class="row">
                            <div class="col-md-4 stretch-card grid-margin">
                                <div class="card bg-gradient-danger card-img-holder text-white">
                                    <div class="card-body">
                                        <img src="assets/images/dashboard/circle.svg" class="card-img-absolute" alt="circle-image" />
                                        <h4 class="font-weight-normal mb-3">Ventas del Mes <i class="mdi mdi-cash-multiple mdi-24px float-right"></i></h4>
                                        <h2 class="mb-5">S/. <span th:text="${ventasMes}">0</span></h2>
                                        <h6 class="card-text">Mi Comisión: S/. <span th:text="${comision}">0</span></h6>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4 stretch-card grid-margin">
                                <div class="card bg-gradient-info card-img-holder text-white">
                                    <div class="card-body">
                                        <img src="assets/images/dashboard/circle.svg" class="card-img-absolute" alt="circle-image" />
                                        <h4 class="font-weight-normal mb-3">Cantidad de Ventas<i class="mdi mdi-trending-up mdi-24px float-right"></i>
                                        <h2 class="mb-5" th:text="${cantidadVentas}">0</h2>
                                        <h6 class="card-text">Operaciones exitosas</h6>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4 stretch-card grid-margin">
                                <div class="card bg-gradient-success card-img-holder text-white">
                                    <div class="card-body">
                                        <img src="assets/images/dashboard/circle.svg" class="card-img-absolute" alt="circle-image" />
                                        <h4 class="font-weight-normal mb-3">Pares Vendidos <i class="mdi mdi-shoe-formal mdi-24px float-right"></i></h4>
                                        <h2 class="mb-5" th:text="${paresVendidos}">0</h2>
                                        <h6 class="card-text">Total de calzado entregado</h6>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-12 grid-margin stretch-card">
                                <div class="card shadow-sm border-0" style="border-radius: 15px;">
                                    <div class="card-body py-4 text-center">
                                        <h4 class="text-uppercase text-muted mb-3" style="letter-spacing: 2px;">Producto más vendido por ti</h4>
                                        <h1 class="display-4 text-primary font-weight-bold" th:text="${productoEstrella}">-</h1>
                                    </div>
                                </div>
                            </div>
                        </div>
						<div class="row mt-4 justify-content-right">
						    <div class="col-md-8 grid-margin stretch-card">
						        <div class="card shadow-sm" style="border-radius:15px;">
						            
						            <div class="card-body text-right">
						                
						                <h5 class="card-title mb-4">Mis Categorías Top</h5>

						                <div class="d-flex justify-content-center align-items-right"
						                     style="height:420px;">
						                     
						                    <div style="position:relative; width:100%; max-width:550px;">
						                        <canvas id="graficoCategorias"></canvas>
						                    </div>

						                </div>

						            </div>
						        </div>
						    </div>
						</div>



                    </div> </div>
            </div>
        </div>
    </div>

	<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
	
	<script th:inline="javascript">

	let datos = [[${categoriasTop}]];

	let nombres = [];
	let cantidades = [];

	datos.forEach(function(item){
	    nombres.push(item[0]);
	    cantidades.push(item[1]);
	});

	const ctx = document.getElementById('graficoCategorias');

	new Chart(ctx, {
	    type: 'pie', 
	    data: {
	        labels: nombres,
	        datasets: [{
	            label: 'Pares vendidos',
	            data: cantidades
	        }]
	    },
		options: {
		    responsive: true,
		    maintainAspectRatio: false
		}

	});
	</script>



	
    <script src="assets/vendors/js/vendor.bundle.base.js"></script>  
    <script src="assets/vendors/chart.js/chart.umd.js"></script> 
    <script src="assets/vendors/bootstrap-datepicker/bootstrap-datepicker.min.js"></script> 
    <script src="assets/js/off-canvas.js"></script> 
    <script src="assets/js/misc.js"></script> 
    <script src="assets/js/settings.js"></script> 
    <script src="assets/js/todolist.js"></script> 
    <script src="assets/js/jquery.cookie.js"></script> 
    <script src="assets/js/dashboard.js"></script> 
</body>
</html>